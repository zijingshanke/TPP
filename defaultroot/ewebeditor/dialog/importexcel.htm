<HTML> <HEAD> <meta http-equiv="Content-Type" content="text/html; charset=utf-8"> <script type="text/javascript" src="dialog.js"></script> <script type="text/javascript">document.write("<link href='../language/"+lang.ad+".css' type='text/css' rel='stylesheet'>");document.write("<link href='../skin/"+config.Skin+"/dialog.css' type='text/css' rel='stylesheet'>");document.write("<TITLE>"+lang["DlgExcel"]+"</TITLE>");function ac(){if(!cr(true)){return;}if(d_sheet.length<=0){alert(lang["DlgExcelInvalidFile"]);return;}var oM=d_sheet.options[d_sheet.selectedIndex].value;var bL=d_file.value;var aC="";aC+="optimizemode:"+(d_opt2.checked?"2":"1")+";";aC+="opt1vml:"+(d_opt1vml.checked?"1":"0")+";";aC+="opt1space:"+(d_opt1space.checked?"1":"0")+";";aC+="opt1table:"+(d_opt1table.checked?"1":"0")+";";aC+="opt1overflow:"+(d_opt1overflow.checked?"1":"0")+";";aC+="opt2image:"+(d_opt2image.checked?"1":"0")+";";aC+="opt2space:"+(d_opt2space.checked?"1":"0")+";";aC+="opt2table:"+(d_opt2table.checked?"1":"0")+";";ah.style.display="";O.ImportExcelSheet(bL,oM,aC);window.setTimeout("dS()",100);};function dS(){if(O.Status!="ok"){window.setTimeout("dS()",100);return;}if(dc()){ah.style.display="none";return;}var ee=O.Style;if(d_opt2.checked){ee="";}var cd=O.Body;var cx=O.OriginalFiles;var dP=O.SavedFiles;if(cx){var cc=cx.split("|");var bb=dP.split("|");for(var i=0;i<cc.length;i++){if(bb[i]){var ei=cc[i];var dY=bb[i].substr(bb[i].lastIndexOf("/")+1);var ed=bb[i];dialogArguments.addUploadFile(ei,dY,ed);}}}if(d_pos.checked){dialogArguments.setHTML(ee+cd,true);}else{var ck="<SPAN id=eWebEditorTempInsertTag></SPAN>";dialogArguments.insertHTML(ck);var cj=dialogArguments.getHTML();var bd=cj.indexOf(ck);var bN=ee+cj.substring(0,bd)+cd+cj.substr(bd+ck.length);dialogArguments.setHTML(bN,true);}O=null;ah.style.display="none";window.returnValue=null;window.close();};var fY="";function pN(){if(!cr(true)){return;}var bL=bF(d_file.value);if((fY!=bL)){d_sheet.options.length=0;fY="";}if(bL==""){return;}if(bL.indexOf(":")<0){return;}if((fY!="")&&(fY==bL)){return;}if(!dU(bL,"xls")){return;}var pV=O.GetExcelWorkSheetName(bL);if(dc()){return;}var kM=pV.split("\n");for(var i=0;i<kM.length;i++){d_sheet.options[d_sheet.options.length]=new Option(kM[i],i+1);}fY=bL;O=null;};function ek(index){var eo,pJ;for(var i=1;i<=2;i++){eo=document.getElementById("group_opt"+i);pJ=eo.getElementsByTagName("INPUT");for(var j=0;j<pJ.length;j++){if(index==i){pJ[j].disabled=false;}else{pJ[j].disabled=true;}}pJ=eo.getElementsByTagName("SPAN");for(var j=0;j<pJ.length;j++){if(index==i){pJ[j].disabled=false;}else{pJ[j].disabled=true;}}}};function J(){lang.aD(document);aE();ek(1);gC();};function gC(){var nF=document.getElementById("ah");nF.style.left=(ar.offsetWidth+6-parseInt(nF.style.width))/2+"px";nF.style.top=(ar.offsetHeight-parseInt(nF.style.height))/2+"px";}</script> <BODY onload="J()"> <table border=0 cellpadding=0 cellspacing=5 id=ar><tr><td> <table border=0 cellpadding=0 cellspacing=0 align=center> <tr> <td> <fieldset> <legend><span lang=DlgExcelLegend></span>:</legend> <table border=0 cellpadding=5 cellspacing=0 width="100%"> <tr><td> <table border=0 cellpadding=0 cellspacing=2 width="100%"> <tr> <td noWrap><span lang=DlgExcelFile></span>:</td> <td noWrap width="100%"><input type=file id="d_file" size=30 style="width:100%" onchange="pN()" onkeyup="pN()"></td> </tr> <tr> <td noWrap><span lang=DlgExcelSheet></span>:</td> <td noWrap><select id="d_sheet" size=1 style="width:100%"></select></td> </tr> </table> </td></tr> </table> </fieldset> </td> </tr> <tr><td height=5></td></tr> <tr> <td> <fieldset> <legend><span lang=DlgExcelOptimize></span>:</legend> <table border=0 cellpadding=5 cellspacing=0 width="100%"> <tr><td> <table border=0 cellpadding=0 cellspacing=3> <tr><td colspan=5 noWrap><input type=radio name="d_optimize" id="d_opt1" checked onclick="ek(1)"><label for=d_opt1><span lang=DlgExcelOpt1></span></label></td></tr> <tr id=group_opt1> <td>&nbsp;&nbsp;&nbsp; </td> <td noWrap><input type=checkbox id=d_opt1vml checked><label for=d_opt1vml><span lang=DlgExcelOpt1VML></span></label></td> <td noWrap><input type=checkbox id=d_opt1space><label for=d_opt1space><span lang=DlgExcelOpt1Space></span></label></td> <td noWrap><input type=checkbox id=d_opt1table checked><label for=d_opt1table><span lang=DlgExcelOpt1Table></span></label></td> <td noWrap><input type=checkbox id=d_opt1overflow><label for=d_opt1overflow><span lang=DlgExcelOpt1Overflow></span></label></td> </tr> <tr><td colspan=5 noWrap><input type=radio name="d_optimize" id="d_opt2" onclick="ek(2)"><label for=d_opt2><span lang=DlgExcelOpt2></span></label></td></tr> <tr id=group_opt2> <td>&nbsp; </td> <td noWrap><input type=checkbox id=d_opt2image checked><label for=d_opt2image><span lang=DlgExcelOpt2Image></span></label></td> <td noWrap><input type=checkbox id=d_opt2space><label for=d_opt2space><span lang=DlgExcelOpt2Space></span></label></td> <td noWrap><input type=checkbox id=d_opt2table checked><label for=d_opt2table><span lang=DlgExcelOpt2Table></span></label></td> <td></td> </tr> </table> </td></tr> </table> </fieldset> </td> </tr> <tr><td height=5></td></tr> <tr> <td> <table border=0 cellpadding=0 cellspacing=0 width="100%"> <tr> <td noWrap><input type=checkbox id=d_pos checked><label for=d_pos><span lang=DlgComInsertReplace></span></label></td> <td noWrap align=right><input type=submit class="dlgBtnCommon" value='' id=Ok onclick="ac()" lang=DlgBtnOK>&nbsp;&nbsp;<input type=button class="dlgBtnCommon" value='' onclick="window.close();" lang=DlgBtnCancel> </tr> </table> </td> </tr> </table> </td></tr></table> <div id=ah style="width:200px;height:30px;position:absolute;left:60px;top:85px;display:none"> <table border=0 cellpadding=0 cellspacing=1 bgcolor="#000000" width="100%" height="100%"><tr><td bgcolor=#3A6EA5 align=center><marquee align="middle" behavior="alternate" scrollamount="5"><font color=#FFFFFF><span lang=DlgExcelImporting></span></font></marquee></td></tr></table> </div> </body> </html> 